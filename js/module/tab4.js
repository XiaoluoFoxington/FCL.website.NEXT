import{loadModule}from"/js/module/moduleLoader.js";export async function xf_init(){await xf_loadTab4Content();xf_loadTrafficInfo();const contributors=await getContributors();xf_generateContributors(contributors);xf_generateDownloadLines(contributors);const useProjects=await xf_getUseProjects();xf_generateUseProjects(useProjects)}export function xf_loadTrafficInfo(){xf_loadWay2TrafficInfo("https://mirror.frostlynx.work/stats")}export async function xf_loadWay2TrafficInfo(url="/data/content/way2Traffic.json"){const loadContent=await loadModule("/js/module/loadContent.js");const trafficEl=document.getElementById("xf_fclWay2Traffic");const totalEl=document.getElementById("xf_fclWay2Total");try{const apiData=await loadContent.fetchItems(url);trafficEl.textContent=apiData.total_gigabytes_transferred+"GiB"||"N/A";totalEl.textContent=apiData.total_downloads||"N/A"}catch(error){console.error("获取线2流量信息失败:",error);trafficEl.textContent=error.message;totalEl.textContent=error.message;return}}export async function getContributors(){const loadContent=await loadModule("/js/module/loadContent.js");return await loadContent.fetchItems("/data/content/contributors.json")}export function getDownloadLines(contributors){const lines=[];contributors.forEach((contributor=>{if(contributor.lines&&contributor.lines.length>0){contributor.lines.forEach((lineId=>{lines.push({id:lineId,provider:contributor.name,providerId:contributor.id})}))}}));return lines.sort(((a,b)=>a.id-b.id))}export function xf_generateContributors(contributors){const contributorsContainer=document.getElementById("contributorsPanel");if(!contributorsContainer)return;contributorsContainer.innerHTML="";contributors.forEach((contributor=>{let linksHtml="";if(contributor.github){linksHtml+=`<a href="https://github.com/${contributor.github}" target="_blank" class="mdui-btn mdui-btn-block mdui-btn-raised mdui-ripple">GitHub</a>`}if(contributor.bilibili){linksHtml+=`<a href="https://space.bilibili.com/${contributor.bilibili}" target="_blank" class="mdui-btn mdui-btn-block mdui-btn-raised mdui-ripple">BiliBili</a>`}if(contributor.qq){linksHtml+=`<a href="https://qm.qq.com/q/${contributor.qq}" target="_blank" class="mdui-btn mdui-btn-block mdui-btn-raised mdui-ripple">QQ</a>`}if(contributor.email){linksHtml+=`<a href="mailto:${contributor.email}" target="_blank" class="mdui-btn mdui-btn-block mdui-btn-raised mdui-ripple">Email</a>`}if(contributor.homepage){linksHtml+=`<a href="${contributor.homepage}" target="_blank" class="mdui-btn mdui-btn-block mdui-btn-raised mdui-ripple">Homepage</a>`}const contributionsHtml=contributor.contributions.map((item=>`<li>${item}</li>`)).join("");const contributorHtml=`\n      <a name="${contributor.id}"></a>\n      <div class="mdui-panel-item mdui-panel-item-open">\n        <div class="mdui-panel-item-header mdui-ripple">\n          <div>${contributor.name}</div>\n          <i class="mdui-panel-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>\n        </div>\n        <div class="mdui-panel-item-body mdui-container-fluid">\n          <div class="mdui-row">\n            <div class="mdui-col-xs-12 mdui-col-sm-4">\n              <div class="mdui-card">\n                <div class="mdui-card-media">\n                  <img src="${contributor.avatar}" loading="lazy"/>\n                  <div class="mdui-card-media-covered">\n                    <div class="mdui-card-primary">\n                      <div class="mdui-card-primary-title">${contributor.name}</div>\n                      ${contributor.id!==contributor.name?`<div class="mdui-card-primary-subtitle">${contributor.id}</div>`:""}\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div>\n                ${linksHtml}\n              </div>\n            </div>\n            <div class="mdui-typo mdui-col-xs-12 mdui-col-sm-8">\n              <p>\n              <ul>\n                ${contributionsHtml}\n              </ul>\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    `;contributorsContainer.insertAdjacentHTML("beforeend",contributorHtml)}))}export function xf_generateDownloadLines(contributors){const linesContainer=document.getElementById("downloadLinesTableBody");if(!linesContainer)return;linesContainer.innerHTML="";const downloadLines=getDownloadLines(contributors);downloadLines.forEach((line=>{const lineHtml=`\n      <tr>\n        <td>线路${line.id}</td>\n        <td><a href="#${line.providerId}">${line.provider}</a></td>\n      </tr>\n    `;linesContainer.insertAdjacentHTML("beforeend",lineHtml)}))}export async function xf_loadTab4Content(){const loadContent=await loadModule("/js/module/loadContent.js");await loadContent.xf_loadHtmlContentFromUrl("/page/tab4.html",document.getElementById("tab4"))}export async function xf_getUseProjects(){const loadContent=await loadModule("/js/module/loadContent.js");return loadContent.fetchItems("/data/content/useProject.json")}export function xf_generateUseProjects(useProjects){const useProjectsContainer=document.getElementById("useProjectTableBody");if(!useProjectsContainer)return;useProjectsContainer.innerHTML="";useProjects.forEach((project=>{const projectHtml=`\n      <tr>\n        <td>${project.name}</td>\n        <td>${project.description}</td>\n        <td>${project.useDescription}</td>\n        <td>${project.useVersion}</td>\n        <td><a href="${project.link}" target="_blank">${project.link}</a></td>\n        <td><a href="${project.licenseLink}" target="_blank">${project.license}</a></td>\n      </tr>\n    `;useProjectsContainer.insertAdjacentHTML("beforeend",projectHtml)}))}