import{loadModule}from"/js/module/moduleLoader.js";export function show(sysInfoEle){const uap=new UAParser;const result=uap.getResult();console.log("系统检测：",result);const osn=result.os.name;const osv=result.os.version;const cpuarch=result.cpu.architecture||navigator.platform;const bn=result.browser.name;sysInfoEle.innerHTML="";addSysInfoItem(sysInfoEle,navigator.userAgent);if(osn!=="Android"){addSysErrItem(sysInfoEle,"当前系统不是安卓系统，无法运行。")}else if(parseInt(osv)<9){addSysErrItem(sysInfoEle,"当前系统版本过低，无法运行。")}else if(cpuarch){const archMap=[{reg:/aarch64|arm64|armv8/i,msg:"请选择通用架构或“arm64-v8a”架构。"},{reg:/armeabi-v7a|(arm$)|armv7/i,msg:"请选择通用架构或“armeabi-v7a”架构。"},{reg:/x86_64|x64|amd64/i,msg:"请选择通用架构或“x86_64”架构。"},{reg:/x86|i[36]86/i,msg:"请选择通用架构或“x86”架构。"}];const matchItem=archMap.find((item=>item.reg.test(cpuarch)));if(matchItem){addSysGreenItem(sysInfoEle,matchItem.msg)}else{addSysInfoItem(sysInfoEle,"请选择通用架构。")}}if(!["Chrome","Mobile Chrome","Firefox","Mobile Firefox","Edge","Opera","Safari","Mobile Safari"].includes(bn)){addSysWarnItem(sysInfoEle,"建议使用常用浏览器（例如 Chrome、Firefox、Edge），因为某些浏览器会“掉包”下载内容。")}if(bn==="Vivo Browser"){addSysErrItem(sysInfoEle,"vivo品牌手机自带浏览器会“掉包”下载内容。")}if(bn==="WeChat"||isAndroidQQInnerWebView(navigator.userAgent)){addSysErrItem(sysInfoEle,"不建议使用微信/QQ自带浏览器，请复制网址到浏览器中打开！")}}export function addSysInfoItem(sysInfoEle,content){const itemEle=document.createElement("div");itemEle.innerHTML=`\n  <div class="mdui-panel-item mdui-panel-item-open">\n    <div class="mdui-panel-item-body mdui-typo" style='padding: 12px; padding-bottom: 0px;'>\n      <p><i class="mdui-icon material-icons">info</i>${content}</p>\n    </div>\n  </div>\n  `;sysInfoEle.appendChild(itemEle)}export function addSysWarnItem(sysInfoEle,content){const itemEle=document.createElement("div");itemEle.innerHTML=`\n  <div class="mdui-panel-item mdui-panel-item-open" style="background-color: #ffff0040;">\n    <div class="mdui-panel-item-body mdui-typo" style='padding: 12px; padding-bottom: 0px;'>\n      <p><i class="mdui-icon material-icons">warning</i>${content}</p>\n    </div>\n  </div>\n  `;sysInfoEle.appendChild(itemEle)}export function addSysErrItem(sysInfoEle,content){const itemEle=document.createElement("div");itemEle.innerHTML=`\n  <div class="mdui-panel-item mdui-panel-item-open" style="background-color: #ff000040;">\n    <div class="mdui-panel-item-body mdui-typo" style='padding: 12px; padding-bottom: 0px;'>\n      <p><i class="mdui-icon material-icons">cancel</i>${content}</p>\n    </div>\n  </div>\n  `;sysInfoEle.appendChild(itemEle)}export function addSysGreenItem(sysInfoEle,content){const itemEle=document.createElement("div");itemEle.innerHTML=`\n  <div class="mdui-panel-item mdui-panel-item-open" style="background-color: #00ff0040;">\n    <div class="mdui-panel-item-body mdui-typo" style='padding: 12px; padding-bottom: 0px;'>\n      <p><i class="mdui-icon material-icons">check_circle</i>${content}</p>\n    </div>\n  </div>\n  `;sysInfoEle.appendChild(itemEle)}function isAndroidQQInnerWebView(userAgent){if(typeof userAgent!=="string"){return false}const ua=userAgent.toLowerCase();const hasAndroid=ua.includes("android");const hasVAS=ua.includes("v1_and_sq_");const hasQQTheme=ua.includes("qqtheme/");const hasQQVersion=ua.includes("qq/");const hasWebView=ua.includes("wv");const isQQInnerWebView=hasAndroid&&hasVAS&&hasQQTheme&&hasQQVersion&&hasWebView;console.log("系统检测：是安卓版QQ内置WebView：",isQQInnerWebView);return isQQInnerWebView}