import{loadModule}from"/js/module/moduleLoader.js";export async function xf_init(){console.log("xf_init()"),await xf_loadTab1Content(),xf_addEventListeners(),xf_loadAnnouncement()}export function xf_addEventListeners(){document.getElementById("loadIntroFclBtn").addEventListener("click",xf_loadIntroFclBtn_Click)}export async function xf_loadIntroFclBtn_Click(){(await loadModule("/js/module/loadContent.js")).xf_loadHtmlContentFromUrl("/page/introFcl.html",document.getElementById("introFcl"))}export async function xf_loadTab1Content(){const loadContent=await loadModule("/js/module/loadContent.js");await loadContent.xf_loadHtmlContentFromUrl("/page/tab1.html",document.getElementById("tab1"))}export async function xf_loadAnnouncement(){const loadContent=await loadModule("/js/module/loadContent.js"),utils=await loadModule("/js/module/utils.js"),savedChecksum=utils.xf_readLocalStorage("xf_announcement_checksum");console.log("tab1：加载公告内容：已存校验值：",savedChecksum);const contentElement=await loadContent.xf_getHtmlContent("/data/content/announcement.html");if(contentElement instanceof HTMLSpanElement&&contentElement.textContent.startsWith("获取 HTML 内容：出错："))return void console.error("tab1：加载公告内容：出错：",contentElement.textContent);const currentContentText=contentElement?.innerHTML||"",currentChecksum=utils.xf_calculateChecksum(currentContentText);console.log("tab1：加载公告内容：当前校验值：",currentChecksum);const contentContainer=document.getElementById("xf_announcementContent"),titleElement=document.getElementById("xf_announcementTitle");if(!contentContainer||!titleElement)return void console.error("tab1：加载公告内容：出错：找不到容器");contentContainer.innerHTML="",contentElement&&contentContainer.appendChild(contentElement),null!==savedChecksum&&parseInt(savedChecksum,10)===currentChecksum?(console.log("tab1：加载公告内容：公告为旧"),titleElement.innerHTML="公告"):(console.log("tab1：加载公告内容：公告为新"),titleElement.innerHTML='公告 <span style="color: #ff0;">●</span>');const panelItem=document.getElementById("xf_announcement");panelItem&&(panelItem.dataset.xfAnnouncementListenerAdded||(panelItem.addEventListener("click",(function(){titleElement.innerHTML="公告",utils.xf_writeLocalStorage("xf_announcement_checksum",currentChecksum.toString())})),panelItem.dataset.xfAnnouncementListenerAdded="true"))}